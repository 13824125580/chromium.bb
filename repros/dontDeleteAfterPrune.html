<html><body>
<div id="editBody" contenteditable="true"><table style="color: rgb(0, 0, 0); font-size: small; font-family: 'Courier New', Courier, 'BB.FixedWidth'; font-style: inherit; border-collapse: collapse; border: 1px solid rgb(83, 83, 83); margin-right: 5px; margin-left: 1px; min-width: 40%; max-width: 100%; margin-top: 0px;"><tbody style="margin-bottom: 0px; margin-top: 0px;"><tr id="theTr" style="margin-bottom: 0px; margin-top: 0px; border-top-width: 0px; border-top-style: solid; border-top-color: rgb(83, 83, 83);"><td id="theTd" style="vertical-align: top; min-width: 50px; padding: 3px; height: 20px; min-height: 20px; margin-bottom: 0px; margin-top: 0px; border: 1px solid rgb(192, 192, 192); text-align: right;">content</td></tr></tbody>
    </table>
    <br style="color: rgb(0, 0, 0); font-family: 'Courier New', Courier, 'BB.FixedWidth'; font-size: small; white-space: pre-wrap;">
</div>
</body>
<script>
    window.setTimeout(function() {
        var editBody = document.getElementById('editBody');
        var theTr = document.getElementById('theTr');
        var theTd = document.getElementById('theTd');
        var sel = document.getSelection();
        console.log('-1');
        var r = document.createRange();
        r.setStart(theTd.firstChild, 0);
        r.setEnd(theTr, 1);
        console.log(r);
        sel.removeAllRanges();
        sel.addRange(r);
        console.log(sel);
        editBody.focus();
    }, 0);

    document.onmouseup = function() {
        console.log(document.getSelection().getRangeAt(0));
    };
</script>
</html>
